# 設計

設計とアーキテクチャに違いはない

# 目的

求められるシステムを**構築、保守**するために必要な**人材を最小限に抑える**こと

> 開発者はスクラッチからシステム全体を再設計することが答えだと考えているかもしれない。
崩壊をもたらした自信過剰が、今度は競争をやり直せばもっとうまく構築できるという話に変わっている。
**自信過剰による再設計は、元のプロジェクトと同じように崩壊する。**
> 

## なぜこれが目的なのか？

ソフトウェアは、**振る舞い**と**構造**の２つを提供する**。**

**ソフト**ウェアは、変更が容易であること。対するハードウェアは変更をしない前提である。

変更の難易度は、変更の形状ではなく、変更のスコープに比例している必要がある。つまり、振る舞いの変更量に対して変更難易度は決まるべきである。

この理想に常に近い状態にしておくために、正しい設計が必要になる。

# クラス設計の原則(SOLID原則)

## SRP:単一責任の原則

### モジュール(クラス)はたったひとつのアクターに対して責務を負うべきである

つまりは、アクターが異なる複数のクラスから、同じクラスを呼ぶことはしてはいけない。

アクターとは、ユースケース図におけるアクター(アクターは人物だけではない)

アクターが振る舞いを決めている。アクターが異なると、異なる要求(振る舞い)を求められる可能性がある。そのため、変化の中で、共通化していたものが共通化できなくなることがある。

だから前もってアクターが異なる場合は、処理も分けることで、関係のないアクターの変更要求でクラスが変更されることを避けることができる。

https://www.ogis-ri.co.jp/otc/hiroba/others/OOcolumn/single-responsibility-principle.html

DDDにおけるドメインモデルは、システム共通のデータ構造や概念であり、アクターもシステム共通アクターになりえる。ただし、例えば同じ”商品”というドメインでも、アクターが異なれば”商品”を構成する要素や商品の振る舞いは変わる可能性がある。これは、区切られた文脈によって、ユビキタス言語の定義が異なることと、同じことを指している。

### DRYはどう考えたらいいのか？

共通化するためには、アクターを正しく認識する必要がある。

単一のアクターに対してDRYを適用することは可能である。

### ユースケース図のアクターって何？

アクター（Actor）とは、システムと直接的なやり取りを行う「役割（Role）」を抽象化したものである 。アクターはシステム境界の外部に位置し、システムに対して何らかの刺激（入力データやトリガー）を与えたり、システムから何らかの結果（出力データや価値）を受け取ったりする実体である。

[**UMLユースケース図におけるアクターの構造的定義と実践的応用に関する包括的研究報告書**](https://www.notion.so/UML-2ddc8c538db280309b8cd0aaca2f36d1?pvs=21)

システム内部のクラスや計算モデル、データベースそのものはアクターには該当しない。(データベースを介してデータをやり取りする外部システムはアクターに該当する)

### Utilityクラスみたいなモノはどう考える？

アクターが存在しない層(クラス)は存在してもよい。

アクターが存在しないとは、以下のような技術的アクターを対象としてる場合。

- 文字列操作
- 日付・時刻計算
- 数学的計算
- コレクション操作
- フォーマット変換

純粋技術Utilityとは

- 業務語彙を一切含まない
- 変更理由が「技術的都合」に限定される
- 再利用されても責務は増えない

と説明でき、この場合はSRPの対象外として考えられる。

つまり、ドメイン層より中心にいる？