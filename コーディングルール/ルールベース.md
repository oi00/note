# クラス設計原則一覧

本ドキュメントは、アプリケーションサービスクラスと計算判断クラスを実装する際に従うべき原則をまとめたものです。設計・実装フェーズの指針として活用してください。

---

## ✅ アプリケーションサービスクラスの原則

### 1. ユースケースの明確な実装
- アプリケーションサービスは、1つの明確なユースケース（業務の流れ）を処理する単位で設計する。

### 2. 入出力はDTOを使用する
- 入力は Command や Query、出力は Result や Response などのDTO（Data Transfer Object）を使う。

### 3. 副作用の統制
- 永続化、通知、外部連携などの副作用は、アプリケーションサービスが一元管理する。

### 4. プレゼンテーション層との分離
- プレゼンテーションロジックやインフラ実装に依存せず、純粋なクラスとしてテスト可能であること。

### 5. ドメインロジックの委譲
- ビジネス判断や計算処理はドメインモデル（計算判断クラスなど）に委譲する。

### 6. トランザクション境界の保持
- トランザクションの開始と終了はこの層で完結させ、整合性を保つ。

### 7. インターフェース指向
- リポジトリ、サービス、通知などの依存はすべてインターフェースとして受け取る。

---

## 🔢 計算判断クラスの原則

### 1. 単一責任の保持
- クラスは1つの判断や計算に責任を持つ。

### 2. 自己完結性
- クラスは自身の動作に必要な情報を全て内部に持ち、外部に依存しない。

### 3. 不変性の確保
- すべてのフィールドは基本的に `readonly` もしくは `init` とし、状態は変更不可とする。

### 4. 副作用の排除
- ログ出力、永続化、ネットワーク通信などの副作用は一切持たない。

### 5. 条件分岐の明確化
- 条件分岐は if / switch 文などで明確に記述し、意図を読み取れるようにする。

### 6. 意図の明示
- 変数名やメソッド名で設計意図を表現し、読み手が思考をトレースできるようにする。

### 7. 状態変更の明示的な扱い
- 状態を変更する場合は、新しいインスタンスを生成し、変更後のオブジェクトを戻り値として返す。

### 8. Getter/Setterを持たない
- データアクセスのためのプロパティを公開せず、必要な情報は明確な意図を持ったメソッドで返す。

---

## 補足：副作用とは？
副作用とは、**外部の状態を変更したり、外部からの状態に依存する処理**を指します。例として以下が挙げられます。

- データベースへの保存、更新、削除
- ファイルの読み書き
- ネットワーク通信（API 呼び出しなど）
- コンソール出力やログ出力
- 時刻の取得（`DateTime.Now`など）

計算判断クラスではこれらを排除し、**予測可能で再現性のある挙動**を保証することが求められます。


# 実装チェックリスト：アプリケーションサービスクラス & 計算判断クラス

本ドキュメントは、C#におけるアプリケーションサービスクラスと計算判断クラスを正しく実装するためのチェックリストです。コードレビュー・セルフチェック・設計基準の明文化にご活用ください。

---

## ✅ アプリケーションサービスクラス チェックリスト

| チェック項目 | 確認（✅ / ❌） |
|--------------|----------------|
| クラス名はユースケース（動作）を表す名前になっているか？ | |
| メソッド名は `Execute` などではなく、具体的なアクション名になっているか？ | |
| 入力は DTO（Command）で受け取り、出力も DTO（Result）で返しているか？ | |
| プレゼンテーション層に依存せず、純粋な C# クラスとして呼び出し可能か？ | |
| 処理の流れ（入力 → 検証 → ドメイン操作 → 保存 → 出力）を上から順に書いているか？ | |
| ビジネス判断や計算はドメインクラスに委ねているか？ | |
| リポジトリや送信処理などの副作用はこのクラスで一元管理しているか？ | |
| 状態変更後の永続化処理（Saveなど）を明示的に記述しているか？ | |
| トランザクションの境界がこのクラスで完結しているか？ | |
| 想定内と想定外の例外を適切に分けて処理しているか？ | |
| すべての依存はインターフェースで注入されており、モック可能か？ | |

---

## 🔢 計算判断クラス チェックリスト

| チェック項目 | 確認（✅ / ❌） |
|--------------|----------------|
| クラスは単一の計算または判断に責任を持っているか？ | |
| コンストラクタで受け取った値はプライベートフィールドに保持しているか？ | |
| Getter / Setter を用意せず、不変な状態として設計されているか？ | |
| 状態は基本的に不変（readonly / init）に保たれているか？ | |
| 副作用（ログ出力、永続化、送信など）を一切含まないか？ | |
| 副作用の定義（外部状態の変更）が理解されたうえで排除されているか？ | |
| メソッドはすべて純粋関数に近い形式（同じ入力 → 同じ出力）か？ | |
| 条件分岐が明確に記述され、意図が読み取れるか？ | |
| 計算の途中結果や条件判断を名前付きメソッドに分割しているか？ | |
| 状態変更メソッドは、変更後のインスタンスを戻り値として返しているか？ | |
| クラス単位でテストしやすい構造（外部依存がない）になっているか？ | |

---

## 備考

- ✅：満たしている
- ❌：未対応 or 要改善
- 本チェックリストはプロジェクト内でカスタマイズ・拡張可能です。